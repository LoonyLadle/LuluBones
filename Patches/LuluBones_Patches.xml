<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<Patch>

	<!-- Adds bones to standard base things. -->
	<Operation Class="PatchOperationAdd">
		<xpath>Defs/ThingDef[@Name="AnimalThingBase"]/statBases</xpath>
		<value>
			<BoneAmount>20</BoneAmount>
		</value>
	</Operation>

	<Operation Class="PatchOperationAdd">
		<xpath>Defs/ThingDef[@Name="BaseInsect"]/statBases</xpath>
		<value>
			<BoneAmount>50</BoneAmount>
		</value>
	</Operation>

	<!-- Allow bone to be used as fuel wherever wood is. -->
	<Operation Class="PatchOperationInsert">
		<xpath>Defs/ThingDef/comps/li[@Class="CompProperties_Refuelable"]/fuelFilter/thingDefs/li[text()="WoodLog"]</xpath>
		<value>
			<li>LuluBones_Bone</li>
		</value>
	</Operation>

	<!-- Groups bones with wood in ThingSetMakers; this mostly just prevents them from spawning in weapon stockpiles. -->
	<Operation Class="PatchOperationInsert">
		<xpath>Defs/ThingSetMakerDef//li[text()="WoodLog"]</xpath>
		<value>
			<li>LuluBones_Bone</li>
		</value>
	</Operation>

	<!-- Don't default allow bones to be used to make blunt weapons. -->
	<Operation Class="PatchOperationAdd">
		<xpath>Defs/ThingDef[@Name="BaseMeleeWeapon_Blunt"]/recipeMaker/defaultIngredientFilter/disallowedThingDefs</xpath>
		<value>
			<li>LuluBones_Bone</li>
		</value>
	</Operation>

	<!-- Allow bone and chitin to be processed into chemfuel using the same recipe as for wood. -->
	<Operation Class="PatchOperationAdd">
		<xpath>Defs/RecipeDef[defName="Make_ChemfuelFromWood"]//thingDefs</xpath>
		<value>
			<li>LuluBones_Bone</li>
			<li>LuluBones_Chitin</li>
		</value>
	</Operation>

	<!-- Allow mixing of ingredients when making chemfuel from wood. -->
	<Operation Class="PatchOperationConditional">
		<success>Always</success>
		<xpath>Defs/RecipeDef[defName="Make_ChemfuelFromWood"]/allowMixingIngredients</xpath>
		<nomatch Class="PatchOperationAdd">
			<xpath>Defs/RecipeDef[defName="Make_ChemfuelFromWood"]</xpath>
			<value>
				<allowMixingIngredients>true</allowMixingIngredients>
			</value>
		</nomatch>
	</Operation>

	<!-- Allows woody materials to be used for knives; longswords can be wooden, why not knives?! -->
	<Operation Class="PatchOperationConditional">
		<success>Always</success>
		<xpath>Defs/ThingDef[defName="MeleeWeapon_Knife"]/stuffCategories/li[text()="Woody"]</xpath>
		<nomatch Class="PatchOperationAdd">
			<xpath>Defs/ThingDef[defName="MeleeWeapon_Knife"]/stuffCategories</xpath>
			<value>
				<li>Woody</li>
			</value>
		</nomatch>
	</Operation>

	<!-- Make campfires stuffed. -->
	<Operation Class="PatchOperationSequence">
		<success>Always</success>
		<operations>
			<li Class="PatchOperationTest">
				<xpath>Defs/ThingDef[defName="Campfire"]/stuffCategories</xpath>
				<success>Invert</success>
			</li>
			<li Class="PatchOperationAdd">
				<xpath>Defs/ThingDef[defName="Campfire"]</xpath>
				<value>
					<costStuffCount>20</costStuffCount>
					<stuffCategories>
						<li>Woody</li>
					</stuffCategories>
				</value>
			</li>
			<li Class="PatchOperationRemove">
				<xpath>Defs/ThingDef[defName="Campfire"]/costList</xpath>
			</li>
			<li Class="PatchOperationRemove">
				<xpath>Defs/ThingDef[defName="Campfire"]/constructEffect</xpath>
			</li>
			<li Class="PatchOperationReplace">
				<xpath>Defs/ThingDef[defName="Campfire"]/graphicData/texPath</xpath>
				<value>
					<texPath>Lulu/Bones/Stuffed/Campfire</texPath>
				</value>
			</li>
		</operations>
	</Operation>

	<!-- Make passive coolers stuffed. -->
	<Operation Class="PatchOperationSequence">
		<success>Always</success>
		<operations>
			<li Class="PatchOperationTest">
				<xpath>Defs/ThingDef[defName="PassiveCooler"]/stuffCategories</xpath>
				<success>Invert</success>
			</li>
			<li Class="PatchOperationAdd">
				<xpath>Defs/ThingDef[defName="PassiveCooler"]</xpath>
				<value>
					<costStuffCount>50</costStuffCount>
					<stuffCategories>
						<li>Woody</li>
					</stuffCategories>
				</value>
			</li>
			<li Class="PatchOperationRemove">
				<xpath>Defs/ThingDef[defName="PassiveCooler"]/costList</xpath>
			</li>
			<li Class="PatchOperationRemove">
				<xpath>Defs/ThingDef[defName="PassiveCooler"]/constructEffect</xpath>
			</li>
			<li Class="PatchOperationReplace">
				<xpath>Defs/ThingDef[defName="PassiveCooler"]/graphicData/texPath</xpath>
				<value>
					<texPath>Lulu/Bones/Stuffed/PassiveCooler</texPath>
				</value>
			</li>
		</operations>
	</Operation>

	<!-- Make torch lamps stuffed. -->
	<Operation Class="PatchOperationSequence">
		<success>Always</success>
		<operations>
			<li Class="PatchOperationTest">
				<xpath>Defs/ThingDef[defName="TorchLamp"]/stuffCategories</xpath>
				<success>Invert</success>
			</li>
			<li Class="PatchOperationAdd">
				<xpath>Defs/ThingDef[defName="TorchLamp"]</xpath>
				<value>
					<costStuffCount>20</costStuffCount>
					<stuffCategories>
						<li>Woody</li>
					</stuffCategories>
				</value>
			</li>
			<li Class="PatchOperationRemove">
				<xpath>Defs/ThingDef[defName="TorchLamp"]/costList</xpath>
			</li>
			<li Class="PatchOperationRemove">
				<xpath>Defs/ThingDef[defName="TorchLamp"]/constructEffect</xpath>
			</li>
			<li Class="PatchOperationReplace">
				<xpath>Defs/ThingDef[defName="TorchLamp"]/graphicData/texPath</xpath>
				<value>
					<texPath>Lulu/Bones/Stuffed/TorchLamp</texPath>
				</value>
			</li>

		</operations>
	</Operation>
</Patch>
